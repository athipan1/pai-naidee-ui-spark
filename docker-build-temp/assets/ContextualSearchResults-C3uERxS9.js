import{j as e}from"./ui-CYJXyMFH.js";import{r as s}from"./vendor-BtPQM8GQ.js";import{a,u as t}from"./router-BKNbbwl4.js";import{T as r,a as l,b as i,c as n}from"./tabs-IV55ShO8.js";import{C as c,c as o,a as d,B as m,d as x}from"./index-B3OkbNa5.js";import{B as h}from"./badge-MTT6vMtQ.js";import{H as g,B as u}from"./BottomNavigation-C9yiQNzY.js";import{A as p,a as j,b as N}from"./avatar-DpmXgv69.js";import{O as v}from"./OptimizedImage-afipJHCM.js";import{ak as f,d as y,am as b,f as k,M as w,ao as C,F as L,aR as S,p as R,z as T}from"./icons-Dm8dLJzq.js";import{s as M,a as z}from"./contextualSearchAPI-BpohMIp-.js";import"./three-Bx_9lKOs.js";import"./query-CekFPK04.js";import"./dropdown-menu-CGE9erBO.js";import"./EnhancedToast-DoTOKRv_.js";import"./mockData-yCUV551o.js";const $=({post:a,currentLanguage:t,onLike:r,onComment:l,onShare:i,onLocationClick:n,onUserClick:g,showMetrics:u=!1,className:L})=>{const[S,R]=s.useState(!1),[T,M]=s.useState(!1),z={th:{likes:"ไลค์",comments:"ความคิดเห็น",shares:"แชร์",views:"การดู",seeMore:"ดูเพิ่มเติม",seeLess:"ดูน้อยลง",location:"สถานที่",timeAgo:"เมื่อ",verified:"ยืนยันแล้ว"},en:{likes:"likes",comments:"comments",shares:"shares",views:"views",seeMore:"See more",seeLess:"See less",location:"Location",timeAgo:"ago",verified:"Verified"}}[t],$=e=>e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString(),A=a.caption.length>150,P=A&&!T?a.caption.substring(0,150)+"...":a.caption,F="highlightedCaption"in a,H=F&&a.highlightedCaption!==a.caption?a.highlightedCaption:P;return e.jsxs(c,{className:o("w-full max-w-lg mx-auto overflow-hidden",L),children:[e.jsx(d,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>null==g?void 0:g(a.user.id),children:[e.jsxs(p,{className:"h-10 w-10",children:[e.jsx(j,{src:a.user.avatar,alt:a.user.name}),e.jsx(N,{children:a.user.name.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:a.user.name}),a.user.verified&&e.jsx(f,{className:"h-4 w-4 text-blue-500 flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:(e=>{const s=new Date,a=new Date(e),r=Math.floor((s.getTime()-a.getTime())/36e5);if(r<1)return"th"===t?"เมื่อสักครู่":"Just now";if(r<24)return"th"===t?`${r} ชั่วโมงที่แล้ว`:`${r}h ${z.timeAgo}`;{const e=Math.floor(r/24);return"th"===t?`${e} วันที่แล้ว`:`${e}d ${z.timeAgo}`}})(a.createdAt)}),a.location&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("button",{onClick:()=>a.locationId&&(null==n?void 0:n(a.locationId)),className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(y,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-24",children:"th"===t&&a.location.nameLocal?a.location.nameLocal:a.location.name})]})]})]})]})]}),e.jsx(m,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(b,{className:"h-4 w-4"})})]})}),e.jsx("div",{className:"relative",children:a.media.length>0&&e.jsxs("div",{className:"aspect-square overflow-hidden",children:[e.jsx(v,{src:a.media[0].url,alt:a.media[0].alt||a.caption,className:"w-full h-full object-cover"}),a.media.length>1&&e.jsxs(h,{className:"absolute top-2 right-2 bg-black/70 text-white",children:["+",a.media.length-1]})]})}),e.jsxs(x,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>{R(!S),null==r||r(a.id)},className:o("p-0 h-auto hover:bg-transparent",S?"text-red-500":"text-gray-700 dark:text-gray-300"),children:e.jsx(k,{className:o("h-6 w-6",S&&"fill-current")})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>null==l?void 0:l(a.id),className:"p-0 h-auto text-gray-700 dark:text-gray-300 hover:bg-transparent",children:e.jsx(w,{className:"h-6 w-6"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>null==i?void 0:i(a.id),className:"p-0 h-auto text-gray-700 dark:text-gray-300 hover:bg-transparent",children:e.jsx(C,{className:"h-6 w-6"})})]}),u&&"searchMetrics"in a&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Score: ",a.searchMetrics.finalScore.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-700 dark:text-gray-300 mb-3",children:[e.jsxs("span",{className:"font-semibold",children:[$(a.likeCount)," ",z.likes]}),a.commentCount>0&&e.jsxs("span",{children:[$(a.commentCount)," ",z.comments]}),a.shareCount&&a.shareCount>0&&e.jsxs("span",{children:[$(a.shareCount)," ",z.shares]}),a.viewCount&&a.viewCount>0&&e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[$(a.viewCount)," ",z.views]})]}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:[e.jsx("span",{className:"font-semibold mr-2",children:a.user.name}),e.jsx("span",{className:"inline",dangerouslySetInnerHTML:{__html:F?H:P}}),A&&e.jsx("button",{onClick:()=>M(!T),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 ml-1 font-medium",children:T?z.seeLess:z.seeMore})]}),a.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[a.tags.slice(0,3).map((s,a)=>e.jsxs(h,{variant:"secondary",className:"text-xs",children:["#",s]},a)),a.tags.length>3&&e.jsxs(h,{variant:"outline",className:"text-xs",children:["+",a.tags.length-3]})]}),u&&"matchedTerms"in a&&a.matchedTerms.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:["Matched: ",a.matchedTerms.join(", ")]})]})]})},A=({currentLanguage:c,onLanguageChange:o})=>{const[d]=a(),x=t(),p=d.get("q")||"",[j,N]=s.useState([]),[v,f]=s.useState([]),[b,k]=s.useState(!1),[w,C]=s.useState("all"),[A,P]=s.useState([]),[F,H]=s.useState(0),B={th:{searchResults:"ผลการค้นหา",noResults:"ไม่พบผลลัพธ์",searching:"กำลังค้นหา...",allResults:"ทั้งหมด",posts:"โพสต์",places:"สถานที่",filters:"ตัวกรอง",sort:"เรียงลำดับ",foundResults:"พบ",results:"ผลลัพธ์",in:"ใน",ms:"มิลลิวินาที",expandedSearch:"ขยายการค้นหาเป็น",relatedPosts:"โพสต์ที่เกี่ยวข้อง",exploreNearby:"สำรวจสถานที่ใกล้เคียง",backToHome:"กลับหน้าแรก"},en:{searchResults:"Search Results",noResults:"No results found",searching:"Searching...",allResults:"All",posts:"Posts",places:"Places",filters:"Filters",sort:"Sort",foundResults:"Found",results:"results",in:"in",ms:"ms",expandedSearch:"Expanded search to",relatedPosts:"Related Posts",exploreNearby:"Explore Nearby",backToHome:"Back to Home"}}[c];s.useEffect(()=>{p&&D()},[p,c]);const D=async()=>{if(p.trim()){k(!0);try{const[e,s]=await Promise.all([M(p,{language:c,limit:20}),z(p,10)]);N(e.results),f(s),P(e.expandedTerms),H(e.processingTime),e.results.length>0&&s.length>0?C("all"):e.results.length>0?C("posts"):s.length>0&&C("places")}catch(e){}finally{k(!1)}}},I=e=>{N(s=>s.map(s=>s.id===e?{...s,likeCount:s.likeCount+1}:s))},q=e=>{x(`/attraction/${e}`)},E=e=>{x(`/profile/${e}`)},V=j.length+v.length;return p?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 dark:from-gray-900 dark:to-gray-800",children:[e.jsx(g,{currentLanguage:c,onLanguageChange:o}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:[B.searchResults,': "',p,'"']}),!b&&V>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400 mb-4",children:[e.jsxs("span",{children:[B.foundResults," ",V," ",B.results," ",B.in," ",F,B.ms]}),A.length>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:[B.expandedSearch,":"]}),A.slice(0,3).map((s,a)=>e.jsx(h,{variant:"outline",className:"text-xs",children:s},a)),A.length>3&&e.jsxs(h,{variant:"secondary",className:"text-xs",children:["+",A.length-3]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",className:"h-8",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),B.filters]}),e.jsxs(m,{variant:"outline",size:"sm",className:"h-8",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),B.sort]})]})]}),b?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),B.searching]})}):0===V?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:B.noResults}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"th"===c?"ลองใช้คำค้นหาอื่นหรือปรับเปลี่ยนตัวกรอง":"Try different keywords or adjust your filters"}),e.jsx(m,{onClick:()=>x("/"),children:B.backToHome})]}):e.jsxs(r,{value:w,onValueChange:C,className:"w-full",children:[e.jsxs(l,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsxs(i,{value:"all",className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),B.allResults,e.jsx(h,{variant:"secondary",className:"ml-1",children:V})]}),e.jsxs(i,{value:"posts",className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),B.posts,e.jsx(h,{variant:"secondary",className:"ml-1",children:j.length})]}),e.jsxs(i,{value:"places",className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),B.places,e.jsx(h,{variant:"secondary",className:"ml-1",children:v.length})]})]}),e.jsx(n,{value:"all",className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[j.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:[B.posts," (",j.length,")"]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:j.slice(0,6).map(s=>e.jsx($,{post:s,currentLanguage:c,onLike:I,onLocationClick:q,onUserClick:E,showMetrics:!0},s.id))})]}),v.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:[B.places," (",v.length,")"]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:v.slice(0,6).map(s=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"th"===c&&s.nameLocal?s.nameLocal:s.name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),s.province]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:s.tags.slice(0,3).map((s,a)=>e.jsx(h,{variant:"outline",className:"text-xs",children:s},a))}),e.jsx(m,{size:"sm",className:"w-full",onClick:()=>q(s.id),children:"th"===c?"ดูรายละเอียด":"View Details"})]})},s.id))})]})]})}),e.jsx(n,{value:"posts",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:j.map(s=>e.jsx($,{post:s,currentLanguage:c,onLike:I,onLocationClick:q,onUserClick:E,showMetrics:!0},s.id))})}),e.jsx(n,{value:"places",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:v.map(s=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"th"===c&&s.nameLocal?s.nameLocal:s.name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),s.province," • ",s.category]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:"th"===c&&s.descriptionLocal?s.descriptionLocal:s.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:s.tags.slice(0,3).map((s,a)=>e.jsx(h,{variant:"outline",className:"text-xs",children:s},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{size:"sm",className:"flex-1",onClick:()=>q(s.id),children:"th"===c?"ดูรายละเอียด":"View Details"}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>x(`/nearby/${s.id}`),children:"th"===c?"ใกล้เคียง":"Nearby"})]})]})},s.id))})})]})]}),e.jsx(u,{currentLanguage:c})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 dark:from-gray-900 dark:to-gray-800",children:[e.jsx(g,{currentLanguage:c,onLanguageChange:o}),e.jsxs("div",{className:"container mx-auto px-4 py-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:B.searchResults}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"th"===c?"กรุณาใส่คำค้นหาเพื่อเริ่มต้น":"Please enter a search query to begin"}),e.jsx(m,{onClick:()=>x("/"),children:B.backToHome})]}),e.jsx(u,{currentLanguage:c})]})};export{A as default};
