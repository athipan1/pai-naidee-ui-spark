import{b as e,c as t,u as a}from"./query-CekFPK04.js";import{simulateDelay as r,mockAttractionDetails as i}from"./mockData-yCUV551o.js";const n="http://localhost:5000/api",o=()=>{const e=localStorage.getItem("authToken");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}},s=async(e,t={})=>{const a=await fetch(e,{...t,headers:{...o(),...t.headers||{}}});if(!a.ok){const e=await a.text();throw new Error(e||`HTTP ${a.status}: Request failed`)}return a.json()},l=async e=>{try{return await s(`${n}/attractions/${e}`)}catch(t){await r(300);const a=i[e];if(!a)throw new Error(`Attraction with ID ${e} not found`);return{id:a.id,name:a.name,nameLocal:a.nameLocal,province:a.province,category:a.category,rating:a.rating,reviewCount:a.reviewCount,images:a.images,description:a.description,tags:a.tags,coordinates:a.location,externalLinks:a.externalLinks,lastUpdated:(new Date).toISOString()}}},c=async e=>{try{const t=new URLSearchParams;(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.category)&&t.append("category",e.category),(null==e?void 0:e.search)&&t.append("search",e.search);return await s(`${n}/attractions?${t.toString()}`)}catch(t){await r(500);const a=Object.values(i).map(e=>({id:e.id,name:e.name,nameLocal:e.nameLocal,category:e.category,rating:e.rating,images:e.images}));return{attractions:a,total:a.length,page:(null==e?void 0:e.page)||1,limit:(null==e?void 0:e.limit)||10}}},d=async e=>{try{const t=e?`${n}/attractions/${e}/refresh`:`${n}/attractions/refresh`;return await s(t,{method:"POST"})}catch(t){return await r(200),{success:!0,message:e?`Attraction ${e} data refreshed from cache`:"All attraction data refreshed from cache"}}},u={all:["attractions"],lists:()=>[...u.all,"list"],list:(e={})=>[...u.lists(),e],details:()=>[...u.all,"detail"],detail:e=>[...u.details(),e]},m=(t,a)=>e({queryKey:u.detail(t||""),queryFn:()=>{if(!t)throw new Error("Attraction ID is required");return l(t)},enabled:!!t&&!1!==(null==a?void 0:a.enabled),staleTime:3e5,gcTime:6e5,retry:(e,t)=>!t.message.includes("not found")&&e<2,throwOnError:!1,meta:{errorMessage:"Failed to load attraction details"}}),g=(t,a)=>e({queryKey:u.list(t||{}),queryFn:()=>c(t),enabled:!1!==(null==a?void 0:a.enabled),staleTime:18e4,gcTime:48e4,retry:2,throwOnError:!1,meta:{errorMessage:"Failed to load attractions list"}}),y=()=>{const e=t();return a({mutationFn:async t=>{const a=await d(t);return t?(await e.invalidateQueries({queryKey:u.detail(t)}),await e.invalidateQueries({queryKey:u.lists()})):await e.invalidateQueries({queryKey:u.all}),a},onSuccess:e=>{},onError:e=>{},meta:{errorMessage:"Failed to refresh attraction data"}})},h=(e,t="เกิดข้อผิดพลาด")=>e?(e=>e.message.includes("not found")?"ไม่พบสถานที่ท่องเที่ยวที่คุณต้องการ":e.message.includes("401")||e.message.includes("token")?"กรุณาเข้าสู่ระบบใหม่":e.message||"เกิดข้อผิดพลาดในการโหลดข้อมูล กรุณาลองใหม่อีกครั้ง")(e):t;export{m as a,y as b,h as g,g as u};
